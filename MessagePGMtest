#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Created on Mon Jun  1 09:38:16 2020

@author: detlef
"""

class MyList(list):
    def remove_set(self, rm_set):
        for el in rm_set:
            if el in self:
                self.remove(el)

class BaseClassMSG:
    def __init__(self, parent):
        self.parent = parent
        self.childs = []
        pass
    
    def process_msgs(self, msgs):
        (msgs_all_handled, msgs_all_added) = self.msgs_from_parent(msgs)
        msgs_to_childs = msgs[:]
        msgs_to_childs.remove_set(msgs_all_handled)
        
        for child_object in msgs_to_childs:
            (msgs_handled, msgs_added) = child_object.process_msg(msgs_to_childs + msgs_all_added) #it might be a good idea, that msgs_all_added is passed, than the subchilds can proces output from the subchilds before ?!
            msgs_all_added.remove_set(msgs_handled)
            msgs_all_added += msgs_added
            msgs_all_handled.update(msgs_handled)
        
        # call self.msgs_from_parent a second time? with msgs_all_added and leave the rest????
        (msgs_second_handled, msgs_second_added) = self.msg_from_parent(msgs_to_childs + msgs_all_added)
        
        rest_added_msgs = MyList(msgs_all_added + msgs_second_added)
        msgs_all_handled.update(msgs_second_handled)
        rest_added_msgs.remove_set(msgs_second_handled)
              
        return (msgs_all_handled, rest_added_msgs)
        
    
    # overwrite
    # remove the messages from msg, which are handled (maybe also by the childs??), the rest is kept
    def msg_from_parent(self, msgs):
        return ({}, MyList([])) #return msgs set that where handled and new Messages
    
